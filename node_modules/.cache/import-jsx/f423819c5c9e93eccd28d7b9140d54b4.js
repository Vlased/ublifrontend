const React = require('react');
const importJsx = require('import-jsx');
const {
  EVENT_CHANGE,
  EVENT_END
} = require('../../task-runner');
const TaskList = importJsx('./TaskList');
const throttle = (fn, threshold = 16) => {
  let throttled = false;
  let lastCalledArguments = null;
  const executeAfterThreshold = () => setTimeout(() => {
    if (lastCalledArguments) {
      fn(...lastCalledArguments);
      lastCalledArguments = null;
      executeAfterThreshold();
    } else {
      throttled = false;
    }
  }, threshold);
  return (...args) => {
    if (throttled) {
      lastCalledArguments = args;
    } else {
      throttled = true;
      executeAfterThreshold();
      fn(...args);
    }
  };
};
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      tasks: this.props.taskRunner.getState()
    };
    this.ended = false;
    const updateTasks = () => {
      if (!this.ended) {
        const tasks = this.props.taskRunner.getState();
        this.setState({
          tasks
        });
      }
    };
    this.handleEnd = () => {
      updateTasks();
      this.ended = true;
    };
    this.handleChange = throttle(updateTasks, 200);
  }
  componentDidMount() {
    this.props.taskRunner.on(EVENT_END, this.handleEnd);
    this.props.taskRunner.on(EVENT_CHANGE, this.handleChange);
  }
  componentWillUnmount() {
    this.ended = true;
    this.props.taskRunner.removeListener(EVENT_END, this.handleEnd);
    this.props.taskRunner.removeListener(EVENT_CHANGE, this.handleChange);
  }
  render() {
    return /*#__PURE__*/React.createElement(TaskList, {
      tasks: this.state.tasks
    });
  }
}
module.exports = App;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJpbXBvcnRKc3giLCJFVkVOVF9DSEFOR0UiLCJFVkVOVF9FTkQiLCJUYXNrTGlzdCIsInRocm90dGxlIiwiZm4iLCJ0aHJlc2hvbGQiLCJ0aHJvdHRsZWQiLCJsYXN0Q2FsbGVkQXJndW1lbnRzIiwiZXhlY3V0ZUFmdGVyVGhyZXNob2xkIiwic2V0VGltZW91dCIsImFyZ3MiLCJBcHAiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwic3RhdGUiLCJ0YXNrcyIsInRhc2tSdW5uZXIiLCJnZXRTdGF0ZSIsImVuZGVkIiwidXBkYXRlVGFza3MiLCJzZXRTdGF0ZSIsImhhbmRsZUVuZCIsImhhbmRsZUNoYW5nZSIsImNvbXBvbmVudERpZE1vdW50Iiwib24iLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInJlbW92ZUxpc3RlbmVyIiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJBcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuY29uc3QgaW1wb3J0SnN4ID0gcmVxdWlyZSgnaW1wb3J0LWpzeCcpO1xuY29uc3QgeyBFVkVOVF9DSEFOR0UsIEVWRU5UX0VORCB9ID0gcmVxdWlyZSgnLi4vLi4vdGFzay1ydW5uZXInKTtcblxuY29uc3QgVGFza0xpc3QgPSBpbXBvcnRKc3goJy4vVGFza0xpc3QnKTtcblxuY29uc3QgdGhyb3R0bGUgPSAoZm4sIHRocmVzaG9sZCA9IDE2KSA9PiB7XG4gIGxldCB0aHJvdHRsZWQgPSBmYWxzZTtcbiAgbGV0IGxhc3RDYWxsZWRBcmd1bWVudHMgPSBudWxsO1xuXG4gIGNvbnN0IGV4ZWN1dGVBZnRlclRocmVzaG9sZCA9ICgpID0+XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAobGFzdENhbGxlZEFyZ3VtZW50cykge1xuICAgICAgICBmbiguLi5sYXN0Q2FsbGVkQXJndW1lbnRzKTtcbiAgICAgICAgbGFzdENhbGxlZEFyZ3VtZW50cyA9IG51bGw7XG4gICAgICAgIGV4ZWN1dGVBZnRlclRocmVzaG9sZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3R0bGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSwgdGhyZXNob2xkKTtcblxuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBpZiAodGhyb3R0bGVkKSB7XG4gICAgICBsYXN0Q2FsbGVkQXJndW1lbnRzID0gYXJncztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3R0bGVkID0gdHJ1ZTtcbiAgICAgIGV4ZWN1dGVBZnRlclRocmVzaG9sZCgpO1xuICAgICAgZm4oLi4uYXJncyk7XG4gICAgfVxuICB9O1xufTtcblxuY2xhc3MgQXBwIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdGFza3M6IHRoaXMucHJvcHMudGFza1J1bm5lci5nZXRTdGF0ZSgpLFxuICAgIH07XG5cbiAgICB0aGlzLmVuZGVkID0gZmFsc2U7XG5cbiAgICBjb25zdCB1cGRhdGVUYXNrcyA9ICgpID0+IHtcbiAgICAgIGlmICghdGhpcy5lbmRlZCkge1xuICAgICAgICBjb25zdCB0YXNrcyA9IHRoaXMucHJvcHMudGFza1J1bm5lci5nZXRTdGF0ZSgpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdGFza3MgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuaGFuZGxlRW5kID0gKCkgPT4ge1xuICAgICAgdXBkYXRlVGFza3MoKTtcbiAgICAgIHRoaXMuZW5kZWQgPSB0cnVlO1xuICAgIH07XG4gICAgdGhpcy5oYW5kbGVDaGFuZ2UgPSB0aHJvdHRsZSh1cGRhdGVUYXNrcywgMjAwKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMucHJvcHMudGFza1J1bm5lci5vbihFVkVOVF9FTkQsIHRoaXMuaGFuZGxlRW5kKTtcbiAgICB0aGlzLnByb3BzLnRhc2tSdW5uZXIub24oRVZFTlRfQ0hBTkdFLCB0aGlzLmhhbmRsZUNoYW5nZSk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLmVuZGVkID0gdHJ1ZTtcbiAgICB0aGlzLnByb3BzLnRhc2tSdW5uZXIucmVtb3ZlTGlzdGVuZXIoRVZFTlRfRU5ELCB0aGlzLmhhbmRsZUVuZCk7XG4gICAgdGhpcy5wcm9wcy50YXNrUnVubmVyLnJlbW92ZUxpc3RlbmVyKEVWRU5UX0NIQU5HRSwgdGhpcy5oYW5kbGVDaGFuZ2UpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiA8VGFza0xpc3QgdGFza3M9e3RoaXMuc3RhdGUudGFza3N9IC8+O1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQXBwO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxPQUFPLENBQUM7QUFDOUIsTUFBTUMsU0FBUyxHQUFHRCxPQUFPLENBQUMsWUFBWSxDQUFDO0FBQ3ZDLE1BQU07RUFBRUUsWUFBWTtFQUFFQztBQUFVLENBQUMsR0FBR0gsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBRWhFLE1BQU1JLFFBQVEsR0FBR0gsU0FBUyxDQUFDLFlBQVksQ0FBQztBQUV4QyxNQUFNSSxRQUFRLEdBQUdBLENBQUNDLEVBQUUsRUFBRUMsU0FBUyxHQUFHLEVBQUUsS0FBSztFQUN2QyxJQUFJQyxTQUFTLEdBQUcsS0FBSztFQUNyQixJQUFJQyxtQkFBbUIsR0FBRyxJQUFJO0VBRTlCLE1BQU1DLHFCQUFxQixHQUFHQSxDQUFBLEtBQzVCQyxVQUFVLENBQUMsTUFBTTtJQUNmLElBQUlGLG1CQUFtQixFQUFFO01BQ3ZCSCxFQUFFLENBQUMsR0FBR0csbUJBQW1CLENBQUM7TUFDMUJBLG1CQUFtQixHQUFHLElBQUk7TUFDMUJDLHFCQUFxQixDQUFDLENBQUM7SUFDekIsQ0FBQyxNQUFNO01BQ0xGLFNBQVMsR0FBRyxLQUFLO0lBQ25CO0VBQ0YsQ0FBQyxFQUFFRCxTQUFTLENBQUM7RUFFZixPQUFPLENBQUMsR0FBR0ssSUFBSSxLQUFLO0lBQ2xCLElBQUlKLFNBQVMsRUFBRTtNQUNiQyxtQkFBbUIsR0FBR0csSUFBSTtJQUM1QixDQUFDLE1BQU07TUFDTEosU0FBUyxHQUFHLElBQUk7TUFDaEJFLHFCQUFxQixDQUFDLENBQUM7TUFDdkJKLEVBQUUsQ0FBQyxHQUFHTSxJQUFJLENBQUM7SUFDYjtFQUNGLENBQUM7QUFDSCxDQUFDO0FBRUQsTUFBTUMsR0FBRyxTQUFTZCxLQUFLLENBQUNlLFNBQVMsQ0FBQztFQUNoQ0MsV0FBV0EsQ0FBQ0MsS0FBSyxFQUFFO0lBQ2pCLEtBQUssQ0FBQ0EsS0FBSyxDQUFDO0lBRVosSUFBSSxDQUFDQyxLQUFLLEdBQUc7TUFDWEMsS0FBSyxFQUFFLElBQUksQ0FBQ0YsS0FBSyxDQUFDRyxVQUFVLENBQUNDLFFBQVEsQ0FBQztJQUN4QyxDQUFDO0lBRUQsSUFBSSxDQUFDQyxLQUFLLEdBQUcsS0FBSztJQUVsQixNQUFNQyxXQUFXLEdBQUdBLENBQUEsS0FBTTtNQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDRCxLQUFLLEVBQUU7UUFDZixNQUFNSCxLQUFLLEdBQUcsSUFBSSxDQUFDRixLQUFLLENBQUNHLFVBQVUsQ0FBQ0MsUUFBUSxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDRyxRQUFRLENBQUM7VUFBRUw7UUFBTSxDQUFDLENBQUM7TUFDMUI7SUFDRixDQUFDO0lBRUQsSUFBSSxDQUFDTSxTQUFTLEdBQUcsTUFBTTtNQUNyQkYsV0FBVyxDQUFDLENBQUM7TUFDYixJQUFJLENBQUNELEtBQUssR0FBRyxJQUFJO0lBQ25CLENBQUM7SUFDRCxJQUFJLENBQUNJLFlBQVksR0FBR3BCLFFBQVEsQ0FBQ2lCLFdBQVcsRUFBRSxHQUFHLENBQUM7RUFDaEQ7RUFFQUksaUJBQWlCQSxDQUFBLEVBQUc7SUFDbEIsSUFBSSxDQUFDVixLQUFLLENBQUNHLFVBQVUsQ0FBQ1EsRUFBRSxDQUFDeEIsU0FBUyxFQUFFLElBQUksQ0FBQ3FCLFNBQVMsQ0FBQztJQUNuRCxJQUFJLENBQUNSLEtBQUssQ0FBQ0csVUFBVSxDQUFDUSxFQUFFLENBQUN6QixZQUFZLEVBQUUsSUFBSSxDQUFDdUIsWUFBWSxDQUFDO0VBQzNEO0VBRUFHLG9CQUFvQkEsQ0FBQSxFQUFHO0lBQ3JCLElBQUksQ0FBQ1AsS0FBSyxHQUFHLElBQUk7SUFDakIsSUFBSSxDQUFDTCxLQUFLLENBQUNHLFVBQVUsQ0FBQ1UsY0FBYyxDQUFDMUIsU0FBUyxFQUFFLElBQUksQ0FBQ3FCLFNBQVMsQ0FBQztJQUMvRCxJQUFJLENBQUNSLEtBQUssQ0FBQ0csVUFBVSxDQUFDVSxjQUFjLENBQUMzQixZQUFZLEVBQUUsSUFBSSxDQUFDdUIsWUFBWSxDQUFDO0VBQ3ZFO0VBRUFLLE1BQU1BLENBQUEsRUFBRztJQUNQLG9CQUFPL0IsS0FBQSxDQUFBZ0MsYUFBQSxDQUFDM0IsUUFBUTtNQUFDYyxLQUFLLEVBQUUsSUFBSSxDQUFDRCxLQUFLLENBQUNDO0lBQU0sQ0FBRSxDQUFDO0VBQzlDO0FBQ0Y7QUFFQWMsTUFBTSxDQUFDQyxPQUFPLEdBQUdwQixHQUFHIn0=