{"version":3,"file":"main.4200c39dbd7b48a589f2.hot-update.js","mappings":";;;;;;;;;;;;;;;AACA;AAAA;AAAA;AADA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AADA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;AC5BA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACvBA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA","sources":["webpack://ulbi/./src/pages/ProfilePage/model/services/fetchProfileData/fetchProfileData.ts","webpack://ulbi/./src/pages/ProfilePage/model/services/updateProfileData/updateProfileData.ts","webpack://ulbi/./src/pages/ProfilePage/model/services/validateProfileData/validateProfileData.ts","webpack://ulbi/./src/pages/ProfilePage/model/slice/profileSlice.ts"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit'\nimport { ThunkConfig } from 'app/providers/StoreProvider'\nimport { Profile } from '../../types/profile'\n\nexport const fetchProfileData = createAsyncThunk<Profile, void, ThunkConfig<string>>(\n  'profile/fetchProfileData',\n  async (_, { extra, rejectWithValue }) => {\n    try {\n      const response = await extra.api.get<Profile>('/profile')\n\n      if (!response?.data) {\n        throw new Error()\n      }\n\n      return response.data\n    } catch (e) {\n      return rejectWithValue('Some weird error happened')\n    }\n  }\n)\n","import { createAsyncThunk } from '@reduxjs/toolkit'\nimport { ThunkConfig } from 'app/providers/StoreProvider'\nimport { getProfileForm } from '../../selectors/getProfileForm/getProfileForm'\nimport { Profile, ValidateProfileErrors } from '../../types/profile'\nimport { validateProfileData } from '../validateProfileData/validateProfileData'\n\nexport const updateProfileData = createAsyncThunk<Profile, void, ThunkConfig<ValidateProfileErrors[]>>(\n  'profile/updateProfileData',\n  async (_, { extra, rejectWithValue, getState }) => {\n    try {\n      const formData = getProfileForm(getState())\n\n      const errors = validateProfileData(formData)\n\n      if (errors.length) {\n        return rejectWithValue(errors)\n      }\n\n      const response = await extra.api.put<Profile>('/profile', formData)\n\n      if (!response?.data) {\n        throw new Error()\n      }\n\n      return response.data\n    } catch (e) {\n      return rejectWithValue([ValidateProfileErrors.SERVER_ERROR])\n    }\n  }\n)\n","import { Profile, ValidateProfileErrors } from '../../types/profile'\n\nexport const validateProfileData = (profile?: Profile) => {\n  if (!profile) {\n    return [ValidateProfileErrors.NO_PROFILE_DATA]\n  }\n\n  const { firstName, lastName, age, country } = profile\n  const errors: ValidateProfileErrors[] = []\n\n  if (!firstName || !lastName) {\n    errors.push(ValidateProfileErrors.INCORRECT_USER_DATA)\n  }\n\n  if (!age || !Number.isInteger(age)) {\n    errors.push(ValidateProfileErrors.INCORRECT_USER_AGE)\n  }\n\n  if (!country) {\n    errors.push(ValidateProfileErrors.INCORRECT_USER_COUNTRY)\n  }\n\n  return errors\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { fetchProfileData } from '../services/fetchProfileData/fetchProfileData'\nimport { updateProfileData } from '../services/updateProfileData/updateProfileData'\nimport { Profile, ProfileSchema } from '../types/profile'\n\nconst initialState: ProfileSchema = {\n  readonly: true,\n  isLoading: false\n}\n\nconst profileSlice = createSlice({\n  name: 'profile',\n  initialState,\n  reducers: {\n    setReadonly: (state, action: PayloadAction<boolean>) => {\n      state.readonly = action.payload\n    },\n    cancelEdit: (state) => {\n      state.readonly = true\n      state.form = state.data\n      state.validateErrors = undefined\n    },\n    updateProfile: (state, action: PayloadAction<Profile>) => {\n      state.form = {\n        ...state.form,\n        ...action.payload\n      }\n    }\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchProfileData.pending, (state) => {\n        state.error = undefined\n        state.isLoading = true\n      })\n      .addCase(fetchProfileData.fulfilled, (state, action) => {\n        state.isLoading = false\n        state.data = action.payload\n        state.form = action.payload\n      })\n      .addCase(fetchProfileData.rejected, (state, action) => {\n        state.isLoading = false\n        state.error = action.payload\n      })\n      .addCase(updateProfileData.pending, (state) => {\n        state.error = undefined\n        state.isLoading = true\n      })\n      .addCase(updateProfileData.fulfilled, (state, action) => {\n        state.isLoading = false\n        state.data = action.payload\n        state.form = action.payload\n        state.readonly = true\n        state.validateErrors = undefined\n      })\n      .addCase(updateProfileData.rejected, (state, action) => {\n        state.isLoading = false\n        state.validateErrors = action.payload\n      })\n  }\n})\n\nexport const {\n  actions: profileActions,\n  reducer: profileReducer\n} = profileSlice\n"],"names":[],"sourceRoot":""}